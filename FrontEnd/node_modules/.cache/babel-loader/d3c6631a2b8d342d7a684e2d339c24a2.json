{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport { defineStore } from \"pinia\";\nimport AuthService from \"@/services/account.service\";\nimport CartService from \"@/services/cart.service\";\nimport AdminService from \"@/services/admin.service\";\nexport const useAppStore = defineStore(\"auth\", {\n  state() {\n    return {\n      user: null,\n      products: {},\n      SearchText: \"\",\n      role: \"\",\n      totalCart: 0,\n      typeProducts: []\n    };\n  },\n\n  getters: {\n    isUserLoggedIn(state) {\n      return !!state.user && !!state.user.accessToken;\n    }\n\n  },\n  actions: {\n    formatter(data) {\n      const fm = new Intl.NumberFormat(\"vi-VN\", {\n        style: \"currency\",\n        currency: \"VND\",\n        minimumFractionDigits: 0\n      });\n      data = fm.format(data);\n      return data;\n    },\n\n    loadAuthState() {\n      this.user = JSON.parse(localStorage.getItem(\"user\"));\n\n      if (this.user) {\n        this.role = this.user.role;\n      }\n\n      this.SearchText = \"\";\n    },\n\n    logout() {\n      this.SearchText = \"\";\n      this.role = \"\";\n      this.user = null;\n      localStorage.removeItem(\"user\");\n    },\n\n    async login(user) {\n      const response = await AuthService.login(user);\n\n      if (!response.accessToken) {\n        this.logout();\n        throw new Error(\"Whoops, no access token found!\");\n      }\n\n      this.user = response;\n\n      if (this.user) {\n        this.role = this.user.role;\n      }\n\n      localStorage.setItem(\"user\", JSON.stringify(response));\n      return response;\n    },\n\n    register(user) {\n      this.user = null;\n      return AuthService.register(user);\n    },\n\n    //Loai san pham\n    async retrieveTypeP() {\n      try {\n        this.typeProducts = await AdminService.getAllTypeProducts();\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    //San pham\n    async retrieveProducts() {\n      try {\n        this.products = await AdminService.getAll();\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    //Gio hang\n    async getCartStore() {\n      this.products = await CartService.getCart();\n      this.totalCart = this.products.totalQty;\n    },\n\n    async AddCartStore(id) {\n      await CartService.addCart(id);\n\n      if (this.totalCart) {\n        this.totalCart++;\n      } else {\n        this.totalCart = 0;\n        this.totalCart++;\n      }\n    }\n\n  }\n});","map":{"version":3,"names":["defineStore","AuthService","CartService","AdminService","useAppStore","state","user","products","SearchText","role","totalCart","typeProducts","getters","isUserLoggedIn","accessToken","actions","formatter","data","fm","Intl","NumberFormat","style","currency","minimumFractionDigits","format","loadAuthState","JSON","parse","localStorage","getItem","logout","removeItem","login","response","Error","setItem","stringify","register","retrieveTypeP","getAllTypeProducts","error","console","log","retrieveProducts","getAll","getCartStore","getCart","totalQty","AddCartStore","id","addCart"],"sources":["D:/CT449/BaiTapLon_BanChinhThuc1/FrontEnd/src/stores/app.store.js"],"sourcesContent":["import { defineStore } from \"pinia\";\nimport AuthService from \"@/services/account.service\";\nimport CartService from \"@/services/cart.service\";\nimport AdminService from \"@/services/admin.service\";\n\nexport const useAppStore = defineStore(\"auth\", {\n  state() {\n    return {\n      user: null,\n      products: {},\n      SearchText: \"\",\n      role: \"\",\n      totalCart: 0,\n      typeProducts: [],\n    };\n  },\n  getters: {\n    isUserLoggedIn(state) {\n      return !!state.user && !!state.user.accessToken;\n    },\n  },\n  actions: {\n    formatter(data) {\n      const fm = new Intl.NumberFormat(\"vi-VN\", {\n        style: \"currency\",\n        currency: \"VND\",\n        minimumFractionDigits: 0,\n      });\n      data = fm.format(data);\n      return data;\n    },\n    loadAuthState() {\n      this.user = JSON.parse(localStorage.getItem(\"user\"));\n      if (this.user) {\n        this.role = this.user.role;\n      }\n      this.SearchText = \"\";\n    },\n    logout() {\n      this.SearchText = \"\";\n      this.role = \"\";\n      this.user = null;\n      localStorage.removeItem(\"user\");\n    },\n    async login(user) {\n      const response = await AuthService.login(user);\n\n      if (!response.accessToken) {\n        this.logout();\n        throw new Error(\"Whoops, no access token found!\");\n      }\n\n      this.user = response;\n      if (this.user) {\n        this.role = this.user.role;\n      }\n\n      localStorage.setItem(\"user\", JSON.stringify(response));\n\n      return response;\n    },\n    register(user) {\n      this.user = null;\n      return AuthService.register(user);\n    },\n\n    //Loai san pham\n    async retrieveTypeP() {\n      try {\n        this.typeProducts = await AdminService.getAllTypeProducts();\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    //San pham\n    async retrieveProducts() {\n      try {\n        this.products = await AdminService.getAll();\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    //Gio hang\n    async getCartStore() {\n      this.products = await CartService.getCart();\n      this.totalCart = this.products.totalQty;\n    },\n\n    async AddCartStore(id) {\n      await CartService.addCart(id);\n      if (this.totalCart) {\n        this.totalCart++;\n      } else {\n        this.totalCart = 0;\n        this.totalCart++;\n      }\n    },\n  },\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}