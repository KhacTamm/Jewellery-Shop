{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport { defineStore } from \"pinia\";\nimport AuthService from \"@/services/account.service\";\nimport ProductService from \"@/services/product.service\";\nexport const useAuthStore = defineStore(\"auth\", {\n  state() {\n    return {\n      user: null\n    };\n  },\n\n  getters: {\n    isUserLoggedIn(state) {\n      return !!state.user && !!state.user.accessToken;\n    }\n\n  },\n  actions: {\n    loadAuthState() {\n      this.user = JSON.parse(localStorage.getItem(\"user\"));\n    },\n\n    logout() {\n      this.user = null;\n      localStorage.removeItem(\"user\");\n    },\n\n    async login(user) {\n      const response = await AuthService.login(user);\n\n      if (!response.accessToken) {\n        this.logout();\n        throw new Error(\"Whoops, no access token found!\");\n      }\n\n      this.user = response;\n      localStorage.setItem(\"user\", JSON.stringify(response));\n      return response;\n    },\n\n    register(user) {\n      this.user = null;\n      return AuthService.register(user);\n    },\n\n    async retrieveProducts() {\n      try {\n        this.products = await ProductService.getAll();\n      } catch (error) {\n        console.log(error);\n      }\n    }\n\n  }\n});","map":{"version":3,"names":["defineStore","AuthService","ProductService","useAuthStore","state","user","getters","isUserLoggedIn","accessToken","actions","loadAuthState","JSON","parse","localStorage","getItem","logout","removeItem","login","response","Error","setItem","stringify","register","retrieveProducts","products","getAll","error","console","log"],"sources":["D:/CT449/shoponline/src/stores/auth.store.js"],"sourcesContent":["import { defineStore } from \"pinia\";\nimport AuthService from \"@/services/account.service\";\nimport ProductService from \"@/services/product.service\";\n\nexport const useAuthStore = defineStore(\"auth\", {\n  state() {\n    return {\n      user: null,\n    };\n  },\n  getters: {\n    isUserLoggedIn(state) {\n      return !!state.user && !!state.user.accessToken;\n    },\n  },\n  actions: {\n    loadAuthState() {\n      this.user = JSON.parse(localStorage.getItem(\"user\"));\n    },\n    logout() {\n      this.user = null;\n      localStorage.removeItem(\"user\");\n    },\n    async login(user) {\n      const response = await AuthService.login(user);\n\n      if (!response.accessToken) {\n        this.logout();\n        throw new Error(\"Whoops, no access token found!\");\n      }\n\n      this.user = response;\n\n      localStorage.setItem(\"user\", JSON.stringify(response));\n\n      return response;\n    },\n    register(user) {\n      this.user = null;\n      return AuthService.register(user);\n    },\n    async retrieveProducts() {\n      try {\n        this.products = await ProductService.getAll();\n      } catch (error) {\n        console.log(error);\n      }\n    },\n  },\n});\n"],"mappings":";AAAA,SAASA,WAAT,QAA4B,OAA5B;AACA,OAAOC,WAAP,MAAwB,4BAAxB;AACA,OAAOC,cAAP,MAA2B,4BAA3B;AAEA,OAAO,MAAMC,YAAY,GAAGH,WAAW,CAAC,MAAD,EAAS;EAC9CI,KAAK,GAAG;IACN,OAAO;MACLC,IAAI,EAAE;IADD,CAAP;EAGD,CAL6C;;EAM9CC,OAAO,EAAE;IACPC,cAAc,CAACH,KAAD,EAAQ;MACpB,OAAO,CAAC,CAACA,KAAK,CAACC,IAAR,IAAgB,CAAC,CAACD,KAAK,CAACC,IAAN,CAAWG,WAApC;IACD;;EAHM,CANqC;EAW9CC,OAAO,EAAE;IACPC,aAAa,GAAG;MACd,KAAKL,IAAL,GAAYM,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAAZ;IACD,CAHM;;IAIPC,MAAM,GAAG;MACP,KAAKV,IAAL,GAAY,IAAZ;MACAQ,YAAY,CAACG,UAAb,CAAwB,MAAxB;IACD,CAPM;;IAQP,MAAMC,KAAN,CAAYZ,IAAZ,EAAkB;MAChB,MAAMa,QAAQ,GAAG,MAAMjB,WAAW,CAACgB,KAAZ,CAAkBZ,IAAlB,CAAvB;;MAEA,IAAI,CAACa,QAAQ,CAACV,WAAd,EAA2B;QACzB,KAAKO,MAAL;QACA,MAAM,IAAII,KAAJ,CAAU,gCAAV,CAAN;MACD;;MAED,KAAKd,IAAL,GAAYa,QAAZ;MAEAL,YAAY,CAACO,OAAb,CAAqB,MAArB,EAA6BT,IAAI,CAACU,SAAL,CAAeH,QAAf,CAA7B;MAEA,OAAOA,QAAP;IACD,CArBM;;IAsBPI,QAAQ,CAACjB,IAAD,EAAO;MACb,KAAKA,IAAL,GAAY,IAAZ;MACA,OAAOJ,WAAW,CAACqB,QAAZ,CAAqBjB,IAArB,CAAP;IACD,CAzBM;;IA0BP,MAAMkB,gBAAN,GAAyB;MACvB,IAAI;QACF,KAAKC,QAAL,GAAgB,MAAMtB,cAAc,CAACuB,MAAf,EAAtB;MACD,CAFD,CAEE,OAAOC,KAAP,EAAc;QACdC,OAAO,CAACC,GAAR,CAAYF,KAAZ;MACD;IACF;;EAhCM;AAXqC,CAAT,CAAhC"},"metadata":{},"sourceType":"module"}